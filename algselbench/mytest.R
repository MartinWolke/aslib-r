library(methods)
library(devtools)
library(testthat)
library(llama)
library(digest)
library(mlr)
library(rpart)
load_all(".")

ast = parseASTask("/home/bischl/cos/coseal/data/csp_2010")
sum(ast$feature.values[, -1], na.rm=T)
print(sapply(ast, digest))
lt = convertToLlamaCVFolds(ast, add.feature.costs = F)
print(sum(lt$data$learning_success))
print(sum(lt$data$standard_success))
print(sum(lt$data[, -c(1, 90)]))

lrn = makeLearner("classif.rpart")
res = classify(convertMlrLearnerToLlama(lrn), lt)
p = res$predictions
p = lapply(p, function(x) do.call(rbind, x))
p = do.call(rbind, p)
print(summary(p))
mcp = misclassificationPenalties(lt, res$predictions)
print(mean(unlist(mcp)))
